<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multivariate optimal allocation for different domains in two stage statified sample design — beat.2st • R2BEAT</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multivariate optimal allocation for different domains in two stage statified sample design — beat.2st" />
<meta property="og:description" content="Compute multivariate optimal allocation for different domains corrected considering stratified two stages design" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">R2BEAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/R2BEAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/barcaroli/R2BEAT/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multivariate optimal allocation for different domains in two stage statified sample design</h1>
    
    <div class="hidden name"><code>beth2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute multivariate optimal allocation for different domains corrected considering stratified two stages design</p>
    </div>

    <pre class="usage"><span class='fu'>beat.2st</span>(<span class='no'>stratif</span>, <span class='no'>errors</span>, <span class='no'>des_file</span>, <span class='no'>psu_file</span>, <span class='no'>rho</span>, <span class='kw'>deft_start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>effst</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>epsilon1</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>mmdiff_deft</span> <span class='kw'>=</span> <span class='fl'>1</span>,<span class='kw'>maxi</span> <span class='kw'>=</span> <span class='fl'>20</span>,
    <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>10</span>^(-<span class='fl'>11</span>), <span class='kw'>minnumstrat</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>maxiter1</span> <span class='kw'>=</span> <span class='fl'>25</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>stratif</th>
      <td><p>Data frame of survey strata, for more details see, e.g.,<a href='strata.html'>strata</a>.</p></td>
    </tr>
    <tr>
      <th>errors</th>
      <td><p>Data frame of coefficients of variation for each domain, for more details see, e.g.,<a href='errors.html'>errors</a>.</p></td>
    </tr>
    <tr>
      <th>des_file</th>
      <td><p>Data frame containing information on sampling design variables, for more details see, e.g.,<a href='design.html'>design</a>.</p></td>
    </tr>
    <tr>
      <th>psu_file</th>
      <td><p>Data frame containing information on primary stage units stratification, for more details see, e.g.,<a href='PSU_strat.html'>PSU_strat</a>.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>Data frame of survey strata, for more details see, e.g.,<a href='rho.html'>rho</a>.</p></td>
    </tr>
    <tr>
      <th>deft_start</th>
      <td><p>Data frame of survey strata, for taking into account the initial design effect on each variable, for more details see, e.g.,<a href='deft_start.html'>deft_start</a>.</p></td>
    </tr>
    <tr>
      <th>effst</th>
      <td><p>Data frame of survey strata, for taking into account the estimator effect on each variable, for more details see, e.g.,<a href='effst.html'>effst</a>.</p></td>
    </tr>
    <tr>
      <th>epsilon1</th>
      <td><p>First stop condition: sample sizes differences beetween two iterations; iteration continues until the maximum of sample sizes differences is greater than the default value. The default is 5.</p></td>
    </tr>
    <tr>
      <th>mmdiff_deft</th>
      <td><p>Second stop condition: defts differences beetween two iterations; iteration continues until the maximum of defts largest differences is greater than the default value. The default is 0.06.</p></td>
    </tr>
    <tr>
      <th>maxi</th>
      <td><p>Third stop condition: maximum number of allowed iterations. The default is 20.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>The same as in function <a href='beth1.html'>beat.1st</a>.</p></td>
    </tr>
    <tr>
      <th>minnumstrat</th>
      <td><p>The same as in function <a href='beth1.html'>beat.1st</a>.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>The same as in function <a href='beth1.html'>beat.1st</a>.</p></td>
    </tr>
    <tr>
      <th>maxiter1</th>
      <td><p>The same as in function <a href='beth1.html'>beat.1st</a>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The methodology is a generalization of Bethel multivariate allocation (1989) that extended the Neyman (1959) - Tchuprov (1923) allocation for multi-purpose and multi-domains surveys.
The generalized Bethel’s algorithm allows to determine the optimal sample size for each stratum in a stratified sample design. The overall sample size and the allocation among the different strata is determined starting from the accuracy constraints imposed in the survey on interest estimates.
The optimal allocation is obtained throught a procedure that converge in few iteractions:</p>
<p>The first iteration is a computation of an initial allocation with the multivariate optimal allocation for different domains in one stages statified sample design (the methodology is a generalization for multidomains and multistages designs of Bethel multivariate allocation, 1989).</p>
<p>The correction of the initial allocation is based on an iterative method calculating new allocations and is based on an inflaction of strata variances  using the design effect (Ganninger, 2010).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code>list</code>. The list contains 8 objects:</p>
<dt>iteractions</dt><dd><p>Data frame that for each iteraction provides a summary with the number of Primary Stage Units (<code>PSU_Total</code>) distinguish between Self-Representative (<code>PSU_SR</code>) from Non-Self-Representative (<code>PSU_NSR</code>) and the number of Secondary Stage Units (<code>SSU</code>). This output is also printed to the screen.</p></dd>
<dt>file_strata</dt><dd><p>Input data frame in <code>stratif</code> with the design effect for each variables in each stratum (<code>DEFT1 - DEFTn</code>) and the optimal sample size columns.</p></dd>
<dt>alloc</dt><dd><p>Data frame with optimal (<code>ALLOC</code>), proportional (<code>PROP</code>), equal (<code>EQUAL</code>) sample size allocation.</p></dd>
<dt>planned</dt><dd><p>Data frame with a summary of expected coefficients of variation for each variable in each domain.</p></dd>
<dt>expected</dt><dd><p>Data frame with a summary of realized coefficients of variation with the given optimal allocation for each variable in each domain.</p></dd>
<dt>sensitivity</dt><dd><p>Data frame with a summary of the sensitivity at 10% for each domain and each variable. Sensitivity can be a useful tool to help in finding the best allocation, because it provides a hint of the expected sample size variation for a 10% change in planned CVs.</p></dd>
<dt>deft_c</dt><dd><p>Data frame with the design effect for each variable in each domain in each iteraction. Note that <code>DEFT1_0 - DEFTn_0</code> is always equal to 1 if <code>deft_start</code> is <code>NULL</code>. Instead is equal to <code>deft_start</code>. While <code>DEFT1 - DEFTn</code> are the final design effect related to the given allocation.</p></dd>
<dt>param_alloc</dt><dd><p>A vector with a resume of all the parameter given for the allocation.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cochran, W. (1977) 
  <em>Sampling Techniques.</em> 
  John Wiley &amp; Sons, Inc., New York</p>  
<p>Ganninger, M. (2010). 
  <em>Design effects: model-based versus design-based approach.</em> 
  Vol. 3, p. 174. DEU.</p>  
<p>Neyman, J. (1934). 
  On the two different aspects of the representative method: the method of stratified sampling and the method of purposive selection. 
  <em>Journal of the Royal Statistical Society</em>, 97(4), 558-625.</p>  
<p>Tschuprow, A. A. (1923). On the mathematical expectation of the moments of frequency distributions in the case of correlated observation. 
  (Chapters 4-6). <em>Metron</em>, 1923, 2: 646-683.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load example data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>beat.example</span>)

<span class='co'>## Example 1</span>
<span class='co'># Allocate the sample</span>
<span class='no'>allocation2st_1</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>,<span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;    iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1           0      0       0         0  6858
#&gt; 2           1     16      79        95 17170
#&gt; 3           2     42     161       203 14736
#&gt; 4           3     33     153       186 15273
#&gt; 5           4     36     155       191 15147
#&gt; 6           5     33     156       189 15274
#&gt; 7           6     36     155       191 15146
#&gt; 8           7     33     156       189 15273
#&gt; 9           8     36     155       191 15147
#&gt; 10          9     33     156       189 15274
#&gt; 11         10     36     155       191 15146
#&gt; 12         11     33     156       189 15273
#&gt; 13         12     36     155       191 15147
#&gt; 14         13     33     156       189 15274
#&gt; 15         14     36     155       191 15146
#&gt; 16         15     33     156       189 15273
#&gt; 17         16     36     155       191 15147
#&gt; 18         17     33     156       189 15274
#&gt; 19         18     36     155       191 15146
#&gt; 20         19     33     156       189 15273
#&gt; 21         20     36     155       191 15147</div><div class='input'><span class='co'># The total ammount of sample size is 191 PSU (36 SR + 155 NSR) and 15147 SSU. </span>

<span class='co'>## Example 2</span>
<span class='co'># Assume 13000 SSUs is the maximum sample size to stick to our budget.</span>
<span class='co'># Look at the sensitivity is in DOM1 for REG1 and REG2 due to V1.</span>
<span class='no'>allocation2st_1</span>$<span class='no'>sensitivity</span></div><div class='output co'>#&gt;    Type Dom   V1 V2
#&gt; 1  DOM1   1 1968  1
#&gt; 3  DOM1   2 1061  1
#&gt; 5  DOM2   1    1  1
#&gt; 7  DOM2   2    1  1
#&gt; 9  DOM2   3    1  1
#&gt; 11 DOM2   4    1  1
#&gt; 13 DOM2   5    1  1
#&gt; 15 DOM2   6    1  1</div><div class='input'><span class='co'># We can relax the constraints increasing the expected coefficients of variation for X1 by 10%</span>
<span class='no'>errors1</span> <span class='kw'>&lt;-</span> <span class='no'>errors</span>
<span class='no'>errors1</span>[<span class='fl'>1</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>errors</span>[<span class='fl'>1</span>,<span class='fl'>2</span>]+<span class='no'>errors</span>[<span class='fl'>1</span>,<span class='fl'>2</span>]*<span class='fl'>0.1</span>

<span class='co'># Try the new allocation </span>
<span class='no'>allocation2st_2</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors1</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>,<span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;   iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1          0      0       0         0  5671
#&gt; 2          1     13      68        81 14602
#&gt; 3          2     35     143       178 12492
#&gt; 4          3     29     134       163 12944</div><div class='input'>
<span class='co'>## Example 3</span>
<span class='co'># On the contrary, if we tighten the constraints decreasing the expected coefficients of variation </span>
<span class='co'># for X1 by 10%</span>
<span class='no'>errors2</span> <span class='kw'>&lt;-</span> <span class='no'>errors</span>
<span class='no'>errors2</span>[<span class='fl'>1</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>errors</span>[<span class='fl'>1</span>,<span class='fl'>2</span>]-<span class='no'>errors</span>[<span class='fl'>1</span>,<span class='fl'>2</span>]*<span class='fl'>0.1</span>

<span class='co'># The new allocation leads to a larger sample than the first example (around 18000)</span>
<span class='no'>allocation2st_3</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors2</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>,<span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;    iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1           0      0       0         0  8463
#&gt; 2           1     18      95       113 20796
#&gt; 3           2     55     182       237 17379
#&gt; 4           3     39     175       214 18451
#&gt; 5           4     47     175       222 17957
#&gt; 6           5     41     177       218 18272
#&gt; 7           6     47     174       221 17957
#&gt; 8           7     41     177       218 18272
#&gt; 9           8     47     174       221 17957
#&gt; 10          9     41     177       218 18272
#&gt; 11         10     47     174       221 17957
#&gt; 12         11     41     177       218 18272
#&gt; 13         12     47     174       221 17957
#&gt; 14         13     41     177       218 18272
#&gt; 15         14     47     174       221 17957
#&gt; 16         15     41     177       218 18272
#&gt; 17         16     47     174       221 17957
#&gt; 18         17     41     177       218 18272
#&gt; 19         18     47     174       221 17957
#&gt; 20         19     41     177       218 18272
#&gt; 21         20     47     174       221 17957</div><div class='input'>
<span class='co'>## Example 4</span>
<span class='co'># Sometimes some budget constraints concern the number of PSU involved in the survey.</span>
<span class='co'># Tuning the PSUs number is possible modyfing the MINIMUM in des_file. </span>
<span class='co'># Assume to increase the MINIMUM from 48 to 60</span>
<span class='no'>design1</span> <span class='kw'>&lt;-</span> <span class='no'>design</span>
<span class='no'>design1</span>[,<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='fl'>60</span>
<span class='no'>allocation2st_4</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors2</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design1</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;   iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1          0      0       0         0  8463
#&gt; 2          1     15      79        94 24569
#&gt; 3          2     52     175       227 19798
#&gt; 4          3     38     162       200 21051
#&gt; 5          4     41     166       207 20821
#&gt; 6          5     39     167       206 20971
#&gt; 7          6     40     167       207 20895</div><div class='input'>
<span class='co'># The PSUs numer is decreased, while the SSUs number increased </span>
<span class='co'># due to cluster intra-correlation effect.</span>
<span class='co'># Under the same expected errors, to offset a slight reduction of PSUs (from 221 to 207) </span>
<span class='co'># an increase of SSUs involved is observed.</span>
<span class='no'>allocation2st_3</span>$<span class='no'>expected</span></div><div class='output co'>#&gt;    Type Dom     V1     V2
#&gt; 1  DOM1   1 0.0900 0.0707
#&gt; 3  DOM1   2 0.0899 0.1101
#&gt; 5  DOM2   1 0.0933 0.0736
#&gt; 7  DOM2   2 0.3370 0.2532
#&gt; 9  DOM2   3 0.3004 0.3240
#&gt; 11 DOM2   4 0.4643 0.4893
#&gt; 13 DOM2   5 0.1769 0.2463
#&gt; 15 DOM2   6 0.1136 0.1362</div><div class='input'><span class='no'>allocation2st_4</span>$<span class='no'>expected</span></div><div class='output co'>#&gt;    Type Dom     V1     V2
#&gt; 1  DOM1   1 0.0900 0.0659
#&gt; 3  DOM1   2 0.0899 0.1043
#&gt; 5  DOM2   1 0.0929 0.0685
#&gt; 7  DOM2   2 0.3523 0.2406
#&gt; 9  DOM2   3 0.3031 0.3093
#&gt; 11 DOM2   4 0.4780 0.4533
#&gt; 13 DOM2   5 0.1758 0.2354
#&gt; 15 DOM2   6 0.1132 0.1283</div><div class='input'>
<span class='co'>## Example 5</span>
<span class='co'># On the contrary, assume to decrease the MINIMUM from 48 to 24.</span>
<span class='co'># The SSUs number strongly decrease in the face of an increase of PSUs,</span>
<span class='co'># always under the same expected errors.</span>
<span class='no'>design2</span> <span class='kw'>&lt;-</span> <span class='no'>design</span>
<span class='no'>design2</span>[,<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='fl'>24</span>
<span class='no'>allocation2st_5</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors2</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design2</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;   iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1          0      0       0         0  8463
#&gt; 2          1     38     161       199 13382
#&gt; 3          2     71     222       293 12471
#&gt; 4          3     69     211       280 12503
#&gt; 5          4     69     212       281 12504</div><div class='input'><span class='no'>allocation2st_4</span>$<span class='no'>expected</span></div><div class='output co'>#&gt;    Type Dom     V1     V2
#&gt; 1  DOM1   1 0.0900 0.0659
#&gt; 3  DOM1   2 0.0899 0.1043
#&gt; 5  DOM2   1 0.0929 0.0685
#&gt; 7  DOM2   2 0.3523 0.2406
#&gt; 9  DOM2   3 0.3031 0.3093
#&gt; 11 DOM2   4 0.4780 0.4533
#&gt; 13 DOM2   5 0.1758 0.2354
#&gt; 15 DOM2   6 0.1132 0.1283</div><div class='input'><span class='no'>allocation2st_5</span>$<span class='no'>expected</span></div><div class='output co'>#&gt;    Type Dom     V1     V2
#&gt; 1  DOM1   1 0.0900 0.0842
#&gt; 3  DOM1   2 0.0899 0.1261
#&gt; 5  DOM2   1 0.0934 0.0881
#&gt; 7  DOM2   2 0.3352 0.2862
#&gt; 9  DOM2   3 0.2974 0.3581
#&gt; 11 DOM2   4 0.4478 0.5815
#&gt; 13 DOM2   5 0.1788 0.2765
#&gt; 15 DOM2   6 0.1138 0.1588</div><div class='input'>
<span class='co'># Note that MINIMUM can be different for each stratum.</span>

<span class='co'>## Example 6</span>
<span class='co'># Assume that the SSUs are in turn clusters, for instance households composed by individuals.</span>
<span class='co'># In the previous examples we always derived optimal allocations</span>
<span class='co'># for sample of SSUs (i.e. households, because</span>
<span class='co'># DELTA = 1).</span>
<span class='no'>design</span></div><div class='output co'>#&gt;    STRATUM STRAT_MOS DELTA MINIMUM
#&gt; 1        1   2302353     1      48
#&gt; 2        2    179562     1      48
#&gt; 3        3    371802     1      48
#&gt; 4        4    592303     1      48
#&gt; 5        5    221687     1      48
#&gt; 6        6    440613     1      48
#&gt; 7        7    128230     1      48
#&gt; 8        8    222648     1      48
#&gt; 9        9    287906     1      48
#&gt; 10      10    882718     1      48
#&gt; 11      11    223516     1      48
#&gt; 12      12    883285     1      48
#&gt; 13      13    594988     1      48
#&gt; 14      14    183169     1      48
#&gt; 15      15   3156694     1      48
#&gt; 16      16   1098740     1      48
#&gt; 17      17   1256025     1      48</div><div class='input'><span class='no'>design1</span></div><div class='output co'>#&gt;    STRATUM STRAT_MOS DELTA MINIMUM
#&gt; 1        1   2302353     1      60
#&gt; 2        2    179562     1      60
#&gt; 3        3    371802     1      60
#&gt; 4        4    592303     1      60
#&gt; 5        5    221687     1      60
#&gt; 6        6    440613     1      60
#&gt; 7        7    128230     1      60
#&gt; 8        8    222648     1      60
#&gt; 9        9    287906     1      60
#&gt; 10      10    882718     1      60
#&gt; 11      11    223516     1      60
#&gt; 12      12    883285     1      60
#&gt; 13      13    594988     1      60
#&gt; 14      14    183169     1      60
#&gt; 15      15   3156694     1      60
#&gt; 16      16   1098740     1      60
#&gt; 17      17   1256025     1      60</div><div class='input'><span class='no'>design2</span></div><div class='output co'>#&gt;    STRATUM STRAT_MOS DELTA MINIMUM
#&gt; 1        1   2302353     1      24
#&gt; 2        2    179562     1      24
#&gt; 3        3    371802     1      24
#&gt; 4        4    592303     1      24
#&gt; 5        5    221687     1      24
#&gt; 6        6    440613     1      24
#&gt; 7        7    128230     1      24
#&gt; 8        8    222648     1      24
#&gt; 9        9    287906     1      24
#&gt; 10      10    882718     1      24
#&gt; 11      11    223516     1      24
#&gt; 12      12    883285     1      24
#&gt; 13      13    594988     1      24
#&gt; 14      14    183169     1      24
#&gt; 15      15   3156694     1      24
#&gt; 16      16   1098740     1      24
#&gt; 17      17   1256025     1      24</div><div class='input'><span class='co'># For obtaining a sample in terms of the elements composing SSUs</span>
<span class='co'># (i.e., individuals) is just sufficient to </span>
<span class='co'># modify the DELTA in des_file.</span>
<span class='no'>design3</span> <span class='kw'>&lt;-</span> <span class='no'>design</span>
<span class='no'>design3</span>$<span class='no'>DELTA</span> <span class='kw'>&lt;-</span> <span class='fl'>2.31</span>
<span class='co'># DELTA_IND=2.31, the average size of household in Italy.</span>
<span class='no'>allocation2st_6</span> <span class='kw'>&lt;-</span> <span class='fu'>beat.2st</span>(<span class='kw'>stratif</span><span class='kw'>=</span><span class='no'>strata</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='no'>errors</span>,
<span class='kw'>des_file</span><span class='kw'>=</span><span class='no'>design3</span>, <span class='kw'>psu_file</span><span class='kw'>=</span><span class='no'>PSU_strat</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='no'>rho</span>)</div><div class='output co'>#&gt;   iterations PSU_SR PSU NSR PSU Total   SSU
#&gt; 1          0      0       0         0  6858
#&gt; 2          1      3      43        46 41547
#&gt; 3          2     48     150       198 29305
#&gt; 4          3     30     133       163 31725
#&gt; 5          4     33     137       170 31178</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrea Fasulo, Stefano Falorsi, Alessio Guandalini, Daniela Pagliuca, Marco Dionisio Terribili, Raffaella Cianchetta, Giulio Barcaroli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


