<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R2BEAT
 Optimization of precision constraints • R2BEAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="R2BEAT
 Optimization of precision constraints">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">R2BEAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CVs_optimization.html">R2BEAT
 Optimization of precision constraints</a>
    </li>
    <li>
      <a href="../articles/R2BEAT_methodology.html">R2BEAT methodology and use</a>
    </li>
    <li>
      <a href="../articles/R2BEAT_workflow_from_frame.html">R2BEAT two-stage sampling design workflow starting from the sampling frame</a>
    </li>
    <li>
      <a href="../articles/R2BEAT_workflow.html">R2BEAT two-stage sampling design workflow starting from a previous survey</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/barcaroli/R2BEAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="CVs_optimization_files/kePrint-0.0.1/kePrint.js"></script><link href="CVs_optimization_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>R2BEAT Optimization of precision
constraints</h1>
            
            <h4 data-toc-skip class="date">2026-01-30 <br><br><br>
</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/barcaroli/R2BEAT/blob/master/vignettes/CVs_optimization.Rmd" class="external-link"><code>vignettes/CVs_optimization.Rmd</code></a></small>
      <div class="hidden name"><code>CVs_optimization.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>In a multivariate stratified sampling design procedure, very
often the values of the precision constraints (expressed in terms of
maximum expected coefficients of variation set on the target estimates)
are set taking into account the budget constraints that oblige to a
given affordable sample size. This implies that an expert has to fine
tune the precision constraints (increasing and decreasing them) until a
satisfactory set is determined. When the number of variables and/or
domains is not small, this job can be very expensive. To handle this
issue, a new function, the “pareto” one, has been developed, in order to
determine an optimal solution in terms of precision constraints, given
the affordable sample size.</p></li>
<li><p>Another issue is related to the characteristics of the allocation
of sampling units in the strata: it may happen that it can be very
different from the proportional one. In some cases it may be desirable
to limit the distance between the two allocations, avoiding the cases of
too much oversampling in small strata. It is possible to obtain this,
also in this case by changing the precision constraints. To get this
result, it is possible to make use of a genetic algorithm, that explores
the space of the possible combinations of values of the precision
constraints, with the aim of maximizing the coefficient of correlation
of the two distributions (optimal and proportional
allocations).</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="setting">Setting<a class="anchor" aria-label="anchor" href="#setting"></a>
</h2>
<p>In this study, we assume that the affordable sample size (given the
budget) is set to 50,000. We show how it is possible to start from a
“neutral” set of precision constraints (equal CVs for all variables for
a given domain level), and modify them, so to:</p>
<ul>
<li><p>first, balance the influence of all the variables on the
determination of the best allocation, or at least, to avoid that only a
small fraction plays a role;</p></li>
<li><p>secondly, get the optimal allocation closer to the proportional
one.</p></li>
</ul>
<p>We consider a strata dataframe containing information on labor force
in a country. Each stratum belongs to three different domain levels:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"strata.RData"</span><span class="op">)</span></span>
<span><span class="co"># strata$DOM3 &lt;- NULL  # de-comment if you want to execute on 2 domains</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    24 obs. of  18 variables:</span></span>
<span><span class="co">##  $ STRATUM      : chr  "north_1_3" "north_1_4" "north_1_5" "north_1_6" ...</span></span>
<span><span class="co">##  $ stratum_label: chr  "north_1_3" "north_1_4" "north_1_5" "north_1_6" ...</span></span>
<span><span class="co">##  $ DOM1         : chr  "National" "National" "National" "National" ...</span></span>
<span><span class="co">##  $ DOM2         : Factor w/ 3 levels "north","center",..: 1 1 1 1 1 1 1 1 2 2 ...</span></span>
<span><span class="co">##  $ N            : num  92780 105327 200757 53612 102907 ...</span></span>
<span><span class="co">##  $ M1           : num  0.748 0.776 0.782 0.776 0.757 ...</span></span>
<span><span class="co">##  $ M2           : num  0.227 0.203 0.199 0.203 0.21 ...</span></span>
<span><span class="co">##  $ M3           : num  0.0252 0.0214 0.0192 0.0211 0.0329 ...</span></span>
<span><span class="co">##  $ M4           : num  29464 29364 27095 25726 27749 ...</span></span>
<span><span class="co">##  $ S1           : num  0.434 0.417 0.413 0.417 0.429 ...</span></span>
<span><span class="co">##  $ S2           : num  0.419 0.402 0.399 0.402 0.407 ...</span></span>
<span><span class="co">##  $ S3           : num  0.157 0.145 0.137 0.144 0.178 ...</span></span>
<span><span class="co">##  $ S4           : num  29839 27542 23575 19557 24520 ...</span></span>
<span><span class="co">##  $ CENS         : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ COST         : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ alloc        : num  360 377 682 191 455 373 759 440 181 233 ...</span></span>
<span><span class="co">##  $ SOLUZ        : num  352 368 667 187 444 365 742 431 177 227 ...</span></span>
<span><span class="co">##  $ DOM3         : chr  "north_1_3" "north_1_4" "north_1_5" "north_1_6" ...</span></span></code></pre>
<p>We consider as target variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"active"</span>,<span class="st">"inactive"</span>,<span class="st">"unemployed"</span>,<span class="st">"income_hh"</span><span class="op">)</span></span>
<span><span class="va">target_vars</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "active"     "inactive"   "unemployed" "income_hh"</span></span></code></pre>
<p>We initially set the following precision constraints:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># De-comment if you want to execute on 2 domains</span></span>
<span><span class="co"># cv_equal &lt;- as.data.frame(list(DOM = c("DOM1","DOM2"),</span></span>
<span><span class="co">#                          CV1 = c(0.05,0.05),</span></span>
<span><span class="co">#                          CV2 = c(0.05,0.05),</span></span>
<span><span class="co">#                          CV3 = c(0.05,0.05),</span></span>
<span><span class="co">#                          CV4 = c(0.05,0.05)))</span></span>
<span><span class="co"># De-comment if you want to execute on 3 domains</span></span>
<span><span class="va">cv_equal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DOM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DOM1"</span>,<span class="st">"DOM2"</span>,<span class="st">"DOM3"</span><span class="op">)</span>,</span>
<span>                         CV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                         CV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                         CV3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                         CV4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Coefficients of variation by domain
</caption>
<thead><tr>
<th style="text-align:left;">
DOM
</th>
<th style="text-align:right;">
CV1
</th>
<th style="text-align:right;">
CV2
</th>
<th style="text-align:right;">
CV3
</th>
<th style="text-align:right;">
CV4
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
DOM1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM2
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM3
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
</tbody>
</table>
<p>and proceed with an initial allocation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">equal</span> <span class="op">&lt;-</span> <span class="fu">R2BEAT</span><span class="fu">::</span><span class="fu"><a href="../reference/beth1.html">beat.1st</a></span><span class="op">(</span><span class="va">strata</span>,<span class="va">cv_equal</span><span class="op">)</span></span></code></pre></div>
<p>with the following total sample size:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">equal</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">equal</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 137129</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="modification-of-initial-precision-constraints-to-be-compliant-with-the-sample-size-constraint">2. Modification of initial precision constraints to be compliant
with the sample size constraint<a class="anchor" aria-label="anchor" href="#modification-of-initial-precision-constraints-to-be-compliant-with-the-sample-size-constraint"></a>
</h2>
<p>We now change the initial precision constraints to reach the desired
sample size.</p>
<p>To this aim, we make use of the function ‘pareto’. This function
determines an optimal set of precision constraints, compliant with the
constraint in term of sample size.</p>
<p>Prior to the execution, we set some upper limits to the resulting
precision constraints:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  DOM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DOM3"</span><span class="op">)</span>,</span>
<span>  VAR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>,<span class="st">"V2"</span>,<span class="st">"V3"</span>,<span class="st">"V4"</span><span class="op">)</span>,</span>
<span>  MAX_CV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span>,<span class="fl">0.10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">caps</span></span></code></pre></div>
<pre><code><span><span class="co">##    DOM VAR MAX_CV</span></span>
<span><span class="co">## 1 DOM3  V1    0.1</span></span>
<span><span class="co">## 2 DOM3  V2    0.1</span></span>
<span><span class="co">## 3 DOM3  V3    0.1</span></span>
<span><span class="co">## 4 DOM3  V4    0.1</span></span></code></pre>
<p>In this way, we indicate that whatever solution of the “pareto”
function must be such that in DOM3 no CV can exceed these values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pareto.html">pareto</a></span><span class="op">(</span></span>
<span>  strata <span class="op">=</span> <span class="va">strata</span>,</span>
<span>  current_cvs <span class="op">=</span> <span class="va">cv_equal</span>,</span>
<span>  target_size <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv_caps <span class="op">=</span> <span class="va">caps</span>,</span>
<span>  beat1cv_fun <span class="op">=</span> <span class="va">beat.1cv_2</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  max_same_iter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_dir <span class="op">=</span> <span class="st">"outputs"</span>,</span>
<span>  plot_prefix <span class="op">=</span> <span class="st">"domains"</span>,</span>
<span>  show_targets <span class="op">=</span> <span class="cn">TRUE</span>,     </span>
<span>  show_caps <span class="op">=</span> <span class="cn">TRUE</span>      </span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Start: t=1.0000000000 -&gt; n=137129 </span></span>
<span><span class="co">## Bracket-up: t=1.2500000000 -&gt; n=91446 </span></span>
<span><span class="co">## Bracket-up: t=1.5625000000 -&gt; n=60184 </span></span>
<span><span class="co">## Bracket-up: t=1.9531250000 -&gt; n=39246 </span></span>
<span><span class="co">##   --&gt; Bracket found (t_lo=1.0000000000 infeasible, t_hi=1.9531250000 feasible) </span></span>
<span><span class="co">## Bisect 01: t=1.476562500000 -&gt; n=66988 </span></span>
<span><span class="co">## Bisect 02: t=1.714843750000 -&gt; n=50407 </span></span>
<span><span class="co">## Bisect 03: t=1.833984375000 -&gt; n=44309 </span></span>
<span><span class="co">## Bisect 04: t=1.774414062500 -&gt; n=47213 </span></span>
<span><span class="co">## Bisect 05: t=1.744628906250 -&gt; n=48769 </span></span>
<span><span class="co">## Bisect 06: t=1.729736328125 -&gt; n=49578 </span></span>
<span><span class="co">## Bisect 07: t=1.722290039062 -&gt; n=49988 </span></span>
<span><span class="co">## Bisect 08: t=1.718566894531 -&gt; n=50195 </span></span>
<span><span class="co">## Bisect 09: t=1.720428466797 -&gt; n=50093 </span></span>
<span><span class="co">## Bisect 10: t=1.721359252930 -&gt; n=50041 </span></span>
<span><span class="co">## Bisect 11: t=1.721824645996 -&gt; n=50015 </span></span>
<span><span class="co">## Bisect 12: t=1.722057342529 -&gt; n=50000</span></span></code></pre>
<pre><code><span><span class="co">## PNG saved: /home/runner/work/R2BEAT/R2BEAT/vignettes/outputs/domains_nmax_50000_tol_5_t_1.722057_convergence.png</span></span></code></pre>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-8-2.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-8-3.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-8-4.png" class="r-plt" alt="" width="700"></p>
<pre><code><span><span class="co">## PNG saved: /home/runner/work/R2BEAT/R2BEAT/vignettes/outputs/domains_nmax_50000_tol_5_t_1.722057_allocation.png</span></span></code></pre>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-8-5.png" class="r-plt" alt="" width="700"></p>
<pre><code><span><span class="co">## PDF saved: /home/runner/work/R2BEAT/R2BEAT/vignettes/outputs/domains_CV_and_alloc_nmax_50000_tol_5_t_1.722057342529.pdf</span></span></code></pre>
<p>Now, the sample size is in line with the budget constraint:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">allocation</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 50000</span></span></code></pre>
<p>These are the new CVs:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_pareto</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">expectedCV</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CV"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">cv_pareto</span>,<span class="st">"./outputs/2.pareto_cvs.csv"</span>,sep<span class="op">=</span><span class="st">","</span>,quote<span class="op">=</span><span class="cn">F</span>,row.names<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pareto coefficients of variation
</caption>
<thead><tr>
<th style="text-align:left;">
DOM
</th>
<th style="text-align:right;">
CV1
</th>
<th style="text-align:right;">
CV2
</th>
<th style="text-align:right;">
CV3
</th>
<th style="text-align:right;">
CV4
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
DOM1
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
0.006
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM2
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM3
</td>
<td style="text-align:right;">
0.076
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
0.074
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="get-the-optimal-allocation-closer-to-the-proportional-one">3. Get the optimal allocation closer to the proportional one<a class="anchor" aria-label="anchor" href="#get-the-optimal-allocation-closer-to-the-proportional-one"></a>
</h2>
<p>Consider the last obtained solution:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pareto_alloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/beth1.html">beat.1st</a></span><span class="op">(</span><span class="va">strata</span>,<span class="va">cv_pareto</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Pareto allocation"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"html"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span></span>
<span>    bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"condensed"</span><span class="op">)</span>,</span>
<span>    full_width <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pareto allocation
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
STRATUM
</th>
<th style="text-align:right;">
ALLOC
</th>
<th style="text-align:right;">
PROP
</th>
<th style="text-align:right;">
EQUAL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
north_1_3
</td>
<td style="text-align:left;">
north_1_3
</td>
<td style="text-align:right;">
4938
</td>
<td style="text-align:right;">
2091.890
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_1_4
</td>
<td style="text-align:left;">
north_1_4
</td>
<td style="text-align:right;">
5840
</td>
<td style="text-align:right;">
2374.785
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_1_5
</td>
<td style="text-align:left;">
north_1_5
</td>
<td style="text-align:right;">
6661
</td>
<td style="text-align:right;">
4526.424
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_1_6
</td>
<td style="text-align:left;">
north_1_6
</td>
<td style="text-align:right;">
5614
</td>
<td style="text-align:right;">
1208.778
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_2_3
</td>
<td style="text-align:left;">
north_2_3
</td>
<td style="text-align:right;">
3819
</td>
<td style="text-align:right;">
2320.222
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_2_4
</td>
<td style="text-align:left;">
north_2_4
</td>
<td style="text-align:right;">
3743
</td>
<td style="text-align:right;">
1891.698
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_2_5
</td>
<td style="text-align:left;">
north_2_5
</td>
<td style="text-align:right;">
4416
</td>
<td style="text-align:right;">
4121.281
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
north_2_6
</td>
<td style="text-align:left;">
north_2_6
</td>
<td style="text-align:right;">
3822
</td>
<td style="text-align:right;">
2249.741
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_1_3
</td>
<td style="text-align:left;">
center_1_3
</td>
<td style="text-align:right;">
1127
</td>
<td style="text-align:right;">
4437.004
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_1_4
</td>
<td style="text-align:left;">
center_1_4
</td>
<td style="text-align:right;">
1220
</td>
<td style="text-align:right;">
5871.453
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_1_5
</td>
<td style="text-align:left;">
center_1_5
</td>
<td style="text-align:right;">
1152
</td>
<td style="text-align:right;">
2556.196
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_1_6
</td>
<td style="text-align:left;">
center_1_6
</td>
<td style="text-align:right;">
910
</td>
<td style="text-align:right;">
352.947
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_2_3
</td>
<td style="text-align:left;">
center_2_3
</td>
<td style="text-align:right;">
743
</td>
<td style="text-align:right;">
2278.037
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_2_4
</td>
<td style="text-align:left;">
center_2_4
</td>
<td style="text-align:right;">
743
</td>
<td style="text-align:right;">
1060.510
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_2_5
</td>
<td style="text-align:left;">
center_2_5
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
668.986
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
center_2_6
</td>
<td style="text-align:left;">
center_2_6
</td>
<td style="text-align:right;">
605
</td>
<td style="text-align:right;">
563.331
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_1_3
</td>
<td style="text-align:left;">
south_1_3
</td>
<td style="text-align:right;">
536
</td>
<td style="text-align:right;">
1377.992
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_1_4
</td>
<td style="text-align:left;">
south_1_4
</td>
<td style="text-align:right;">
509
</td>
<td style="text-align:right;">
1664.088
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_1_5
</td>
<td style="text-align:left;">
south_1_5
</td>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
3097.838
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_1_6
</td>
<td style="text-align:left;">
south_1_6
</td>
<td style="text-align:right;">
416
</td>
<td style="text-align:right;">
1286.587
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_2_3
</td>
<td style="text-align:left;">
south_2_3
</td>
<td style="text-align:right;">
520
</td>
<td style="text-align:right;">
1238.405
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_2_4
</td>
<td style="text-align:left;">
south_2_4
</td>
<td style="text-align:right;">
543
</td>
<td style="text-align:right;">
932.580
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_2_5
</td>
<td style="text-align:left;">
south_2_5
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
1596.560
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
south_2_6
</td>
<td style="text-align:left;">
south_2_6
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
234.667
</td>
<td style="text-align:right;">
2083.417
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
50002
</td>
<td style="text-align:right;">
50002.000
</td>
<td style="text-align:right;">
50002.000
</td>
</tr>
</tbody>
</table>
<p>We can calculate the Pearson correlation coefficient between the
optimal and proportional allocations:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span>,<span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">PROP</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3467993</span></span></code></pre>
<p>We want to get the optimal allocation closer to the proportional one.
For instance, we want that the correlation coefficient be increased to
0.9.</p>
<p>To obtain this result, we make use of a particular genetic algorithm,
the quantum genetic algorithm, implemented in the R package QGA.</p>
<div class="section level3">
<h3 id="fitness-function">3.1 Fitness function<a class="anchor" aria-label="anchor" href="#fitness-function"></a>
</h3>
<p>First, we define the following fitness function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitness_cvs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">solution</span>,<span class="va">eval_func_inputs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">strata</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">vett</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">vettmin</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">vettmax</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">nvals</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">nvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">cv_corr</span> <span class="op">&lt;-</span> <span class="va">cv</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nvars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="va">cv_corr</span><span class="op">[</span><span class="va">k</span>,<span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">vettmin</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,</span>
<span>                            to<span class="op">=</span><span class="va">vettmax</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,</span>
<span>                            by<span class="op">=</span><span class="op">(</span><span class="va">vettmax</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">-</span><span class="va">vettmin</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">nvals</span><span class="op">)</span><span class="op">[</span><span class="va">solution</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">cv_corr</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">R2BEAT</span><span class="fu">::</span><span class="fu"><a href="../reference/beth1.html">beat.1st</a></span><span class="op">(</span><span class="va">strata</span>,<span class="va">cv_corr</span><span class="op">)</span></span>
<span>  <span class="co"># b &lt;- ks.test(a$alloc$ALLOC[-nrow(a$alloc)],a$alloc$PROP[-nrow(a$alloc)])</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span>,<span class="va">a</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">PROP</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="co">#---------- Fitness function ----------------</span></span>
<span>  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">c</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setting-the-parameters">3.2 Setting the parameters<a class="anchor" aria-label="anchor" href="#setting-the-parameters"></a>
</h3>
<p>We set the parameters required by the QGA function:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">vett</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vett</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vett</span>,<span class="va">cv_pareto</span><span class="op">[</span><span class="va">k</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">nvars</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">vett</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">vett</span><span class="op">)</span></span>
<span><span class="va">vettmin</span> <span class="op">&lt;-</span> <span class="va">vett</span> <span class="op">*</span> <span class="fl">0.65</span></span>
<span><span class="va">vettmax</span> <span class="op">&lt;-</span> <span class="va">vett</span> <span class="op">*</span> <span class="fl">1.35</span></span>
<span><span class="va">Genome</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vett</span><span class="op">)</span></span>
<span><span class="co"># Genome = nrow(strata)</span></span>
<span><span class="va">nvalues_sol</span> <span class="op">=</span> <span class="fl">16384</span>    <span class="co"># 2^14 ==&gt; 14 qubits</span></span>
<span><span class="va">eval_func_inputs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">strata</span>,</span>
<span>                        <span class="va">vett</span>,</span>
<span>                        <span class="va">cv_pareto</span>,</span>
<span>                        <span class="va">vettmin</span>,</span>
<span>                        <span class="va">vettmax</span>,</span>
<span>                        <span class="va">nvalues_sol</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="va">popsize</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">generation_max</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">nvalues_sol</span> <span class="op">=</span> <span class="va">nvalues_sol</span></span>
<span><span class="va">thetainit</span> <span class="op">=</span> <span class="fl">3.1415926535</span> <span class="op">*</span> <span class="fl">0.5</span></span>
<span><span class="va">thetaend</span> <span class="op">=</span> <span class="fl">3.1415926535</span> <span class="op">*</span> <span class="fl">0.025</span></span>
<span><span class="va">pop_mutation_rate_init</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">popsize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pop_mutation_rate_end</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">popsize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mutation_rate_init</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">Genome</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mutation_rate_end</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">Genome</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mutation_flag</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="va">plotting</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="va">verbose</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="va">progress</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="va">eval_fitness</span> <span class="op">=</span> <span class="va">fitness_cvs</span></span>
<span><span class="va">eval_func_inputs</span> <span class="op">=</span> <span class="va">eval_func_inputs</span></span>
<span><span class="va">stop_limit</span> <span class="op">=</span> <span class="fl">0.95</span></span></code></pre></div>
<p>Some explanations regarding the parameters. The parameters ‘vettmin’
and ‘vettmax’ are fundamental to determine the space of possible
solutions.</p>
<p>In fact, consider their values:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vettmin</span></span></code></pre></div>
<pre><code><span><span class="co">##        CV1        CV2        CV3        CV4        CV1        CV2        CV3 </span></span>
<span><span class="co">## 0.00319410 0.00841165 0.01288560 0.00357630 0.01225900 0.02237235 0.02419040 </span></span>
<span><span class="co">##        CV4        CV1        CV2        CV3        CV4 </span></span>
<span><span class="co">## 0.00997685 0.04932265 0.05596305 0.05596695 0.04803565</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vettmax</span></span></code></pre></div>
<pre><code><span><span class="co">##        CV1        CV2        CV3        CV4        CV1        CV2        CV3 </span></span>
<span><span class="co">## 0.00663390 0.01747035 0.02676240 0.00742770 0.02546100 0.04646565 0.05024160 </span></span>
<span><span class="co">##        CV4        CV1        CV2        CV3        CV4 </span></span>
<span><span class="co">## 0.02072115 0.10243935 0.11623095 0.11623905 0.09976635</span></span></code></pre>
<p>The values in vettmin are the minimum values that the CVs can assume,
while the values in vettmax are the maximum ones.</p>
<p>The parameter ‘nvalues_sol’ indicates the number of possible
different values considered for each element in the genome: by setting
it to 16384, it means that for each precision constraint, 16384 possible
values will be considered, the ones obtained by dividing by 16384 the
interval between the minimum and the maximum value set for each
precision constraint.</p>
<p>The parameter ‘eval_func_inputs’ is a list containing all the
information required by the fitness function.</p>
<p>Parameters ‘thetainit’ and ‘thetaend’ are the initial and final
values expressed in degrees for the rotation gate used in the quantum
genetic algorithm. The rotation is high at the beginning of the
iterations (to explore mores solutions), lower at the end (to refine the
best solution found).</p>
<p>The same for parameters from ‘pop_mutation_rate_init’ to
‘pop_mutation_rate_end’, that govern the rate of mutation in the
solutions.</p>
<p>Very important is the ‘stop_limit’ parameter: the iterations are
stopped when this limit is reached. In our case it is set to 0.5: this
means that when the correlation coefficient reaches this limit, the
algorithm stops and output the related solution.</p>
</div>
<div class="section level3">
<h3 id="execution-of-the-genetic-algorithm">3.3 Execution of the genetic algorithm<a class="anchor" aria-label="anchor" href="#execution-of-the-genetic-algorithm"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solutionQGA</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">fitness_best</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">solutionQGA</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9375261</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndoms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#plot vett</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vett</span>, col<span class="op">=</span><span class="st">"black"</span>, type<span class="op">=</span><span class="st">"l"</span>,xaxt <span class="op">=</span> <span class="st">"n"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">vettmin</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">vettmax</span><span class="op">)</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, main<span class="op">=</span><span class="st">"Region of variation for CVs"</span><span class="op">)</span> <span class="co"># xaxt = "n" disables the xaxis ticks</span></span>
<span><span class="co"># Generate the vector of labels</span></span>
<span><span class="va">vector_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"DOM"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ndoms</span>, each <span class="op">=</span> <span class="va">nvars</span><span class="op">)</span>, </span>
<span>                       <span class="st">"_V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nvars</span>, times <span class="op">=</span> <span class="va">ndoms</span><span class="op">)</span>, </span>
<span>                       sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co"># xticks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vett</span><span class="op">)</span><span class="op">)</span>,labels<span class="op">=</span><span class="va">vector_labels</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># vettmin and vettmax</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">vettmin</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">vettmax</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="co"># add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cv_input"</span>, <span class="st">"cv_min"</span>, <span class="st">"cv_max"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu">QGA</span><span class="fu">:::</span><span class="fu">plot_Output</span><span class="op">(</span><span class="va">solutionQGA</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" alt="" width="700"></p>
<p>We decode the QGA solution:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solution</span> <span class="op">&lt;-</span> <span class="va">solutionQGA</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cv_ga</span> <span class="op">&lt;-</span> <span class="va">cv_pareto</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">nvals</span> <span class="op">&lt;-</span> <span class="va">nvalues_sol</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nvars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">diff</span></span>
<span>    <span class="va">cv_ga</span><span class="op">[</span><span class="va">k</span>,<span class="va">m</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">vettmin</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,</span>
<span>                          to<span class="op">=</span><span class="va">vettmax</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>,</span>
<span>                          by<span class="op">=</span><span class="op">(</span><span class="va">vettmax</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">-</span><span class="va">vettmin</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">nvals</span><span class="op">)</span><span class="op">[</span><span class="va">solution</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
GA precision constraints
</caption>
<thead><tr>
<th style="text-align:left;">
DOM
</th>
<th style="text-align:right;">
CV1
</th>
<th style="text-align:right;">
CV2
</th>
<th style="text-align:right;">
CV3
</th>
<th style="text-align:right;">
CV4
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
DOM1
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM2
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM3
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.116
</td>
<td style="text-align:right;">
0.091
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ga_solution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/beth1.html">beat.1st</a></span><span class="op">(</span><span class="va">strata</span>,<span class="va">cv_ga</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ga_solution</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ga_solution</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 51622</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="re-execution-of-the-pareto-function">3.4 Re-execution of the “pareto” function<a class="anchor" aria-label="anchor" href="#re-execution-of-the-pareto-function"></a>
</h3>
<p>With these new precision constraints, the sample size is slightly
greater than the affordable. So, we apply again the “pareto”
function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pareto.html">pareto</a></span><span class="op">(</span></span>
<span>  strata <span class="op">=</span> <span class="va">strata</span>,</span>
<span>  current_cvs <span class="op">=</span> <span class="va">cv_ga</span>,</span>
<span>  target_size <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv_caps <span class="op">=</span> <span class="va">caps</span>,</span>
<span>  beat1cv_fun <span class="op">=</span> <span class="va">beat.1cv_2</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  max_same_iter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_dir <span class="op">=</span> <span class="st">"outputs"</span>,</span>
<span>  plot_prefix <span class="op">=</span> <span class="st">"domains"</span>,</span>
<span>  show_targets <span class="op">=</span> <span class="cn">TRUE</span>,     </span>
<span>  show_caps <span class="op">=</span> <span class="cn">TRUE</span>      </span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Start: t=1.0000000000 -&gt; n=55073 </span></span>
<span><span class="co">## Bracket-up: t=1.2500000000 -&gt; n=43992 </span></span>
<span><span class="co">##   --&gt; Bracket found (t_lo=1.0000000000 infeasible, t_hi=1.2500000000 feasible) </span></span>
<span><span class="co">## Bisect 01: t=1.125000000000 -&gt; n=48144 </span></span>
<span><span class="co">## Bisect 02: t=1.062500000000 -&gt; n=51130 </span></span>
<span><span class="co">## Bisect 03: t=1.093750000000 -&gt; n=49535 </span></span>
<span><span class="co">## Bisect 04: t=1.078125000000 -&gt; n=50307 </span></span>
<span><span class="co">## Bisect 05: t=1.085937500000 -&gt; n=49914 </span></span>
<span><span class="co">## Bisect 06: t=1.082031250000 -&gt; n=50107 </span></span>
<span><span class="co">## Bisect 07: t=1.083984375000 -&gt; n=50011 </span></span>
<span><span class="co">## Bisect 08: t=1.084960937500 -&gt; n=49963 </span></span>
<span><span class="co">## Bisect 09: t=1.084472656250 -&gt; n=49989 </span></span>
<span><span class="co">## Bisect 10: t=1.084228515625 -&gt; n=50000</span></span></code></pre>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-24-2.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-24-3.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-24-4.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-24-5.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-the-final-solution">4. Analysis of the final solution<a class="anchor" aria-label="anchor" href="#analysis-of-the-final-solution"></a>
</h2>
<p>These is the final set of precision constraints:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_final</span> <span class="op">&lt;-</span> <span class="va">out2</span><span class="op">$</span><span class="va">errors_scaled</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cv_final</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_final</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CV"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nvars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Final precision constraints
</caption>
<thead><tr>
<th style="text-align:left;">
DOM
</th>
<th style="text-align:right;">
CV1
</th>
<th style="text-align:right;">
CV2
</th>
<th style="text-align:right;">
CV3
</th>
<th style="text-align:right;">
CV4
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
DOM1
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM2
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.018
</td>
</tr>
<tr>
<td style="text-align:left;">
DOM3
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.098
</td>
</tr>
</tbody>
</table>
<p>that produces the following sample size:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">final_sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/beth1.html">beat.1st</a></span><span class="op">(</span><span class="va">strata</span>,<span class="va">cv_final</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 50000</span></span></code></pre>
<p>in line with the affordable sample size.</p>
<p>What about the closeness of the final optimal allocation to the
proportional one?</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">pareto_alloc</span><span class="op">$</span><span class="va">alloc</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">rng</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ALLOC</span>,<span class="va">df</span><span class="op">$</span><span class="va">PROP</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ALLOC</span>  <span class="op">~</span>  <span class="va">PROP</span>, </span>
<span>     data <span class="op">=</span> <span class="va">df</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Optimal vs Proportional allocation - Before GA adjustment"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Optimal"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Proportional"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="va">rng</span>,</span>
<span>     ylim <span class="op">=</span> <span class="va">rng</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>     bg  <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.8</span>,</span>
<span>  y <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"y = x"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  pos <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ALLOC</span><span class="op">~</span><span class="va">PROP</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">fit</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.75</span>,</span>
<span>  y <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"y = %.2f + %.2f x\nR² = %.2f"</span>,</span>
<span>                   <span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">coefs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">r2</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>  pos <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-28-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">rng</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ALLOC</span>,<span class="va">df</span><span class="op">$</span><span class="va">PROP</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ALLOC</span>  <span class="op">~</span>  <span class="va">PROP</span>, </span>
<span>     data <span class="op">=</span> <span class="va">df</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Optimal vs Proportional allocation - After GA adjustment"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Optimal"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Proportional"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="va">rng</span>,</span>
<span>     ylim <span class="op">=</span> <span class="va">rng</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>     bg  <span class="op">=</span> <span class="st">"steelblue"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.8</span>,</span>
<span>  y <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"y = x"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  pos <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ALLOC</span><span class="op">~</span><span class="va">PROP</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">fit</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.75</span>,</span>
<span>  y <span class="op">=</span> <span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"y = %.2f + %.2f x\nR² = %.2f"</span>,</span>
<span>                   <span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">coefs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">r2</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>  pos <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-28-2.png" class="r-plt" alt="" width="700">
So, we obtained a final optimal solution that is much more close to the
proportional one with respect to the one obtained with the first
application of the “pareto” function.</p>
<p>It is worth noting that the final correlation:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">ALLOC</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span>,<span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">$</span><span class="va">PROP</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_sol</span><span class="op">$</span><span class="va">alloc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7230641</span></span></code></pre>
<p>is not the one that we indicated to and obtained by the genetic
algorithm. This is due to the fact that when re-applying the “pareto”
function, we lost some of the correlation. If we want a higher value of
it we should get back to the genetic algorithm and set a higher value
for the desired correlation.</p>
<p>Finally, we want to compare the different sets of the precision
constraints:</p>
<ul>
<li><p>the initial ones (those obtained by a time consuming human
interaction);</p></li>
<li><p>those obtained by applying the “pareto” function to the set of
equal CVs;</p></li>
<li><p>the final ones, obtained by executing the genetic algorithm to
get the resulting optimal allocation closer to the proportional one (and
adjusted once again with the “pareto” function.</p></li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_domain</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dom_label</span>, <span class="va">cv_pareto</span>, <span class="va">cv_ga</span>, <span class="va">cv_final</span>,</span>
<span>                        <span class="va">series_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>,<span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">vnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cv_pareto</span>, <span class="va">cv_ga</span>, <span class="va">cv_final</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.15</span></span>
<span>  </span>
<span>  <span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>Pareto <span class="op">=</span> <span class="va">cv_pareto</span>, GA <span class="op">=</span> <span class="va">cv_ga</span>, Final <span class="op">=</span> <span class="va">cv_final</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>    <span class="va">heights</span>,</span>
<span>    beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    names.arg <span class="op">=</span> <span class="va">vnames</span>,</span>
<span>    las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cex.names <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ymax</span><span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"CV by variable - Domain:"</span>, <span class="va">dom_label</span><span class="op">)</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"CV"</span>,</span>
<span>    col  <span class="op">=</span> <span class="va">series_cols</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># bp è una matrice 2 x nvar con le x dei bar; prendiamo i centri del gruppo</span></span>
<span>  <span class="va">x_centers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">bp</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># linea tratteggiata (cv_ga)</span></span>
<span>  <span class="co"># lines(x_centers, ga_vals, type = "b", lty = 2, pch = 16)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>    <span class="st">"topleft"</span>,</span>
<span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pareto CVs"</span>, <span class="st">"GA CVs"</span>, <span class="st">"Final CVs"</span><span class="op">)</span>,</span>
<span>    col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">series_cols</span><span class="op">)</span>,</span>
<span>    pch    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>    bty    <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>    cex <span class="op">=</span> <span class="fl">0.7</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">doms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">$</span><span class="va">DOM</span><span class="op">)</span></span>
<span><span class="va">ncols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span></span>
<span><span class="va">vcols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cv_pareto</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">doms</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pareto_row</span>     <span class="op">&lt;-</span> <span class="va">cv_pareto</span><span class="op">[</span><span class="va">cv_pareto</span><span class="op">$</span><span class="va">DOM</span>  <span class="op">==</span> <span class="va">d</span>, <span class="va">vcols</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="va">ga_row</span> <span class="op">&lt;-</span> <span class="va">cv_ga</span><span class="op">[</span><span class="va">cv_ga</span><span class="op">$</span><span class="va">DOM</span> <span class="op">==</span> <span class="va">d</span>, <span class="va">vcols</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="va">final_row</span>     <span class="op">&lt;-</span> <span class="va">cv_final</span><span class="op">[</span><span class="va">cv_final</span><span class="op">$</span><span class="va">DOM</span>  <span class="op">==</span> <span class="va">d</span>, <span class="va">vcols</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pareto_row</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ga_row</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_row</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Dominio "</span>, <span class="va">d</span>, <span class="st">": righe non univoche nei file. Salto."</span><span class="op">)</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">pareto_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pareto_row</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">ga_vals</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ga_row</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">final_vals</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">final_row</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pareto_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ga_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">final_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">vcols</span></span>
<span>  <span class="fu">plot_domain</span><span class="op">(</span>dom_label <span class="op">=</span> <span class="va">d</span>, cv_pareto <span class="op">=</span> <span class="va">pareto_vals</span>, cv_ga <span class="op">=</span> <span class="va">ga_vals</span>, cv_final <span class="op">=</span> <span class="va">final_vals</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="CVs_optimization_files/figure-html/unnamed-chunk-30-1.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-30-2.png" class="r-plt" alt="" width="700"><img src="CVs_optimization_files/figure-html/unnamed-chunk-30-3.png" class="r-plt" alt="" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrea Fasulo, Giulio Barcaroli, Stefano Falorsi, Alessio Guandalini, Ilaria Bombelli, Marco Dionisio Terribili.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
